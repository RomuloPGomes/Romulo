<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inspe√ß√£o OAE - Sistema Offline</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#3498db"/>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Inspe√ß√£o OAE">

    <link rel="stylesheet" href="styles.css">
    <script defer src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîç Inspe√ß√£o OAE</h1>
            <p>Gerenciador Offline de Inspe√ß√µes</p>
            <div id="offlineIndicator" style="display: none; background: rgba(255,255,255,0.2); padding: 5px 10px; border-radius: 15px; margin-top: 10px; font-size: 12px;">
                üì± Funcionando Offline
            </div>
        </div>
        <div class="main-content">
            <div class="tabs">
                <button class="tab active" data-tab="inspecoes">Inspe√ß√µes</button>
                <button class="tab" data-tab="dados_gerais" disabled>Dados Gerais</button>
                <button class="tab" data-tab="registros" disabled>Registros</button>
                <!-- Nova aba Caracter√≠sticas Gerais -->
                <button class="tab" data-tab="caracteristicas_gerais" disabled>Caracter√≠sticas Gerais</button>
            </div>
            <div id="inspecoes" class="tab-content active">
                <div class="section">
                    <div class="section-header">
                        <h3><span class="icon">üìÇ</span> Gerenciar Inspe√ß√£o</h3>
                    </div>
                    <div class="form-group">
                        <label for="inspecaoAtiva">Selecionar Inspe√ß√£o:</label>
                        <select id="inspecaoAtiva"></select>
                    </div>
                    <div class="form-row">
                        <button type="button" class="btn btn-link" id="novaInspecaoBtn">‚ûï Nova Inspe√ß√£o</button>
                        <button type="button" class="btn btn-secondary" id="deletarInspecaoBtn">üóëÔ∏è Deletar Inspe√ß√£o Ativa</button>
                    </div>
                </div>
                
                <div class="section">
                    <div class="section-header">
                        <h3><span class="icon">üìä</span> Importar/Exportar Dados</h3>
                    </div>
                    <div class="form-row">
                        <button type="button" class="btn btn-link" id="downloadTemplateBtn">üì• Baixar Planilha Modelo</button>
                        <button type="button" class="btn btn-link" id="importDataBtn">üì§ Importar Planilha</button>
                    </div>
                    <div id="importStatus" class="form-group" style="display: none;">
                        <p id="importMessage" style="color: #28a745; font-weight: 600; text-align: center; padding: 10px; background: #d4edda; border-radius: 8px;"></p>
                    </div>
                </div>
                
                <div class="section">
                    <div class="section-header">
                        <h3><span class="icon">üìã</span> Lista de Inspe√ß√µes</h3>
                    </div>
                    <div id="inspecoesList" class="registros-list" style="max-height: 300px;">
                        <p style="text-align:center; color:#6c757d; padding: 20px;">Nenhuma inspe√ß√£o criada ainda.</p>
                    </div>
                </div>
                <div class="section">
                    <div class="section-header">
                        <h3><span class="icon">üóëÔ∏è</span> Limpar Todas as Inspe√ß√µes</h3>
                    </div>
                    <div class="form-row">
                        <button type="button" class="btn btn-secondary" id="deletarTudoBtn">üóëÔ∏è Deletar Todas as Inspe√ß√µes</button>
                    </div>
                </div>
            </div>
            <div id="dados_gerais" class="tab-content">
                 <div class="section">
                    <div class="section-header"><h3><span class="icon">üèóÔ∏è</span> Dados Gerais</h3></div>
                    <div class="form-group"><label for="concessionaria">Nome da Concession√°ria:</label><input type="text" id="concessionaria" required></div>
                    <div class="form-row"><div class="form-group"><label for="rodovia">Rodovia:</label><input type="text" id="rodovia" required></div><div class="form-group"><label for="km">km+m:</label><input type="text" id="km" required></div></div>
                    <div class="form-row"><div class="form-group"><label for="latitude">Latitude:</label><input type="number" id="latitude" step="any" placeholder="-22.9068"></div><div class="form-group"><label for="longitude">Longitude:</label><input type="number" id="longitude" step="any" placeholder="-43.1729"></div></div>
                    <button type="button" class="btn btn-location" id="getCoordsBtn">üìç Obter Coordenadas Atuais</button>
                    <div id="copyCoordsContainer" class="copy-coords hidden"><input type="text" id="coordsForCopy" readonly><button type="button" id="copyCoordsBtn" class="btn btn-link">Copiar</button></div>
                    <div class="form-group"><label for="nome_obra">Nome da Obra:</label><input type="text" id="nome_obra" required></div>
                    <div class="form-row"><div class="form-group"><label for="sentido">Sentido Crescente:</label><select id="sentido" required><option value="">Selecione...</option>
<option value="Leste">Leste</option>
<option value="Oeste">Oeste</option>
<option value="Norte">Norte</option>
<option value="Sul">Sul</option></select></div><div class="form-group"><label for="data">Data da Inspe√ß√£o:</label><input type="date" id="data" required></div></div>
                    <div class="form-group"><label for="inspetor">Inspetor:</label><input type="text" id="inspetor" required></div>
                </div>
            </div>
            <div id="registros" class="tab-content">
                <form id="inspectionForm">
                    <div class="section">
                        <div class="section-header"><h3><span class="icon">‚ûï</span> Novo Registro</h3></div>
                        <div class="section">
                            <div class="section-header"><h3><span class="icon">üîß</span> Elemento Inspecionado</h3><button type="button" class="btn btn-link" id="abrirModalLegendas">Consultar Legendas</button></div>
                            <div class="form-group"><label for="elemento">Elemento:</label><select id="elemento" name="elemento" required>
<option value="">Selecione...</option>
<option value="FOTO CAPA PANOR√ÇMICA">FOTO CAPA PANOR√ÇMICA</option>
<option value="AA">AA</option>
<option value="AB">AB</option>
<option value="AC">AC</option>
<option value="AD">AD</option>
<option value="AL">AL</option>
<option value="ALE">ALE</option>
<option value="ALI">ALI</option>
<option value="AP">AP</option>
<option value="B√á">B√á</option>
<option value="BL">BL</option>
<option value="BLC">BLC</option>
<option value="BLOCO DE ANCORAGEM">BLOCO DE ANCORAGEM</option>
<option value="BR">BR</option>
<option value="BU">BU</option>
<option value="BUZ">BUZ</option>
<option value="BZ">BZ</option>
<option value="CABO DE PROTENS√ÉO">CABO DE PROTENS√ÉO</option>
<option value="CEL">CEL</option>
<option value="CO">CO</option>
<option value="DG">DG</option>
<option value="DI">DI</option>
<option value="DM">DM</option>
<option value="DR">DR</option>
<option value="EB">EB</option>
<option value="ENC">ENC</option>
<option value="ET">ET</option>
<option value="GC">GC</option>
<option value="GR">GR</option>
<option value="JANELA">JANELA</option>
<option value="JD">JD</option>
<option value="JUNTA JUSANTE">JUNTA JUSANTE</option>
<option value="L">L</option>
<option value="LB">LB</option>
<option value="LI">LI</option>
<option value="LS">LS</option>
<option value="LT">LT</option>
<option value="MF">MF</option>
<option value="MONTANTE">MONTANTE</option>
<option value="MT">MT</option>
<option value="P">P</option>
<option value="PA">PA</option>
<option value="PC">PC</option>
<option value="PF">PF</option>
<option value="PIL">PIL</option>
<option value="PINGADEIRA">PINGADEIRA</option>
<option value="PISTA">PISTA</option>
<option value="PLACA DE FECHAMENTO">PLACA DE FECHAMENTO</option>
<option value="PR">PR</option>
<option value="PS">PS</option>
<option value="RAMPA">RAMPA</option>
<option value="SAP">SAP</option>
<option value="SH-TACHAS REFLETIVAS">SH-TACHAS REFLETIVAS</option>
<option value="SJ">SJ</option>
<option value="SV-BARREIRAS">SV-BARREIRAS</option>
<option value="SV-GABARITO">SV-GABARITO</option>
<option value="TA">TA</option>
<option value="TESTEIRA">TESTEIRA</option>
<option value="TRAVESSIA">TRAVESSIA</option>
<option value="TRE">TRE</option>
<option value="TRECHO">TRECHO</option>
<option value="TUB">TUB</option>
<option value="TUBO ARMCO">TUBO ARMCO</option>
<option value="TUBULA√á√ÉO DE UTILIDADES">TUBULA√á√ÉO DE UTILIDADES</option>
<option value="V">V</option>
<option value="VA">VA</option>
<option value="VL">VL</option>
<option value="VLR">VLR</option>
<option value="VLT">VLT</option>
<option value="VT">VT</option>
<option value="VTR">VTR</option>
<option value="VTRAV">VTRAV</option>
<option value="FINAL DE INSPE√á√ÉO">FINAL DE INSPE√á√ÉO</option>
</select></div>
                            <div class="form-row"><div class="form-group"><label for="numero_elemento">N√∫mero do Elemento:</label><input type="number" id="numero_elemento" name="numero_elemento" min="1" required></div><div class="form-group"><label for="vao">V√£o (Opcional):</label><select id="vao" name="vao"><option value="">N/A</option>
<script>for(let i=1; i<=50; i++) { document.write(`<option value="V√£o ${String(i).padStart(2, '0')}">V√£o ${String(i).padStart(2, '0')}</option>`); }</script>
</select></div></div>
                            <div class="form-row"><div class="form-group"><label for="face">Face (Opcional):</label><select id="face" name="face"><option value="">N/A</option>
<option value="Norte">Norte</option>
<option value="Sul">Sul</option>
<option value="Leste">Leste</option>
<option value="Oeste">Oeste</option>
<option value="Inferior">Inferior</option>
<option value="Superior">Superior</option>
<option value="Sob a Obra">Sob a Obra</option>
<option value="Sobre a Obra">Sobre a Obra</option>
</select></div><div class="form-group"><label for="vista">Vista (Opcional):</label><select id="vista" name="vista"><option value="">N/A</option>
<option value="Norte - Sul">Norte - Sul</option>
<option value="Sul - Norte">Sul - Norte</option>
<option value="Leste - Oeste">Leste - Oeste</option>
<option value="Oeste - Leste">Oeste - Leste</option>
</select></div></div>
                        </div>
                        <div class="section">
                            <div class="section-header"><h3><span class="icon">‚ö†Ô∏è</span> Anomalias</h3></div>
                            <div class="filter-buttons" id="anomalia-filters">
<button type="button" class="btn-filter active" data-category="todos">Todos</button>
<button type="button" class="btn-filter" data-category="concreto">Concreto</button>
<button type="button" class="btn-filter" data-category="metalica">Met√°licas</button>
<button type="button" class="btn-filter" data-category="pavimentacao">Pavim.</button>
<button type="button" class="btn-filter" data-category="apoios">Apoios</button>
</div>
                            <div class="form-group"><label for="anomalia">Anomalia (Opcional):</label><select id="anomalia" name="anomalia">
<option value="">Selecione...</option>
<optgroup label="1. CONCRETO">
<option data-category="concreto" value="1.1">1.1 - Manchas de umidade</option>
<option data-category="concreto" value="1.2">1.2 - Manchas de umidade ativa</option>
<option data-category="concreto" value="1.3">1.3 - Efloresc√™ncia</option>
<option data-category="concreto" value="1.4">1.4 - Estalactites</option>
<option data-category="concreto" value="1.5">1.5 - Concreto disgregado</option>
<option data-category="concreto" value="1.5-1.17">1.5-1.17 - Concreto disgregado com Armadura Exposta</option>
<option data-category="concreto" value="1.6">1.6 - Concreto segregado</option>
<option data-category="concreto" value="1.6-1.17">1.6-1.17 - Concreto segregado com Armadura Exposta</option>
<option data-category="concreto" value="1.7">1.7 - Concreto desagregado</option>
<option data-category="concreto" value="1.7-1.17">1.7-1.17 - Concreto desagregado com Armadura Exposta</option>
<option data-category="concreto" value="1.8">1.8 - Redu√ß√£o de cobrimento</option>
<option data-category="concreto" value="1.9">1.9 - Fissuras horizontais</option>
<option data-category="concreto" value="1.10">1.10 - Fissuras verticais</option>
<option data-category="concreto" value="1.11">1.11 - Fissuras diagonais</option>
<option data-category="concreto" value="1.12">1.12 - Fissuras mapeadas</option>
<option data-category="concreto" value="1.13">1.13 - Trincas (&gt;0,5 mm)</option>
<option data-category="concreto" value="1.14">1.14 - Reparos locais inadequados</option>
<option data-category="concreto" value="1.15">1.15 - Fora de prumo</option>
<option data-category="concreto" value="1.16">1.16 - Desplacamento</option>
<option data-category="concreto" value="1.16-1.17">1.16-1.17 - Desplacamento com Armadura Exposta</option>
<option data-category="concreto" value="1.17">1.17 - Armadura exposta</option>
<option data-category="concreto" value="1.18">1.18 - Manchas enegrecidas</option>
<option data-category="concreto" value="1.19">1.19 - Incid√™ncia de vegeta√ß√£o</option>
<option data-category="concreto" value="1.20">1.20 - Deslocamento linear ou angular</option>
<option data-category="concreto" value="1.21">1.21 - Resto de forma</option>
<option data-category="concreto" value="1.22">1.22 - Drenos de inje√ß√£o n√£o arrematados</option>
<option data-category="concreto" value="1.23">1.23 - Falha no acabamento dos nichos de ancoragens das armaduras protendidas</option>
</optgroup>
<optgroup label="2. ESTRUTURAS MET√ÅLICAS">
<option data-category="metalica" value="2.1">2.1 - Falha de acabamento na soldagem</option>
<option data-category="metalica" value="2.2">2.2 - Corros√£o</option>
<option data-category="metalica" value="2.3">2.3 - Empeno/Deforma√ß√£o</option>
<option data-category="metalica" value="2.4">2.4 - Falta de parafusos, porcas e arruelas</option>
<option data-category="metalica" value="2.5">2.5 - Falha de pintura</option>
<option data-category="metalica" value="2.6">2.6 - Trinca transpassante</option>
<option data-category="metalica" value="2.7">2.7 - Infiltra√ß√£o no parafuso</option>
<option data-category="metalica" value="2.8">2.8 - Oxida√ß√£o</option>
<option data-category="metalica" value="2.9">2.9 - Buzinotes curtos, danificados ou ausentes</option>
<option data-category="metalica" value="2.10">2.10 - Calcina√ß√£o</option>
</optgroup>
<optgroup label="3. PAVIMENTA√á√ÉO E SISTEMA VI√ÅRIO">
<option data-category="pavimentacao" value="3.1">3.1 - Fuga de material, exist√™ncia de eros√£o e ind√≠cios de instabilidade do talude</option>
<option data-category="pavimentacao" value="3.2">3.2 - Desgaste superficial, espessura excessiva, ondula√ß√µes e cavidades no pavimento</option>
<option data-category="pavimentacao" value="3.3">3.3 - Defici√™ncia e/ou aus√™ncia de sinaliza√ß√£o horizontal, vertical e a√©rea</option>
<option data-category="pavimentacao" value="3.4">3.4 - Descontinuidade do greide</option>
<option data-category="pavimentacao" value="3.5">3.5 - Defici√™ncia no sistema de drenagem</option>
<option data-category="pavimentacao" value="3.6">3.6 - Aus√™ncia de perfil de veda√ß√£o na junta de dilata√ß√£o</option>
<option data-category="pavimentacao" value="3.7">3.7 - Falta de estanqueidade na junta de dilata√ß√£o</option>
<option data-category="pavimentacao" value="3.8">3.8 - Sali√™ncia ou depress√£o causando desconforto ao usu√°rio ou impacto na obra</option>
<option data-category="pavimentacao" value="3.9">3.9 - Deteriora√ß√£o dos l√°bios polim√©ricos</option>
<option data-category="pavimentacao" value="3.10">3.10 - Deteriora√ß√£o dos ber√ßos na junta de dilata√ß√£o</option>
<option data-category="pavimentacao" value="3.11">3.11 - Ac√∫mulo de detritos na junta de dilata√ß√£o</option>
<option data-category="pavimentacao" value="3.12">3.12 - Perfil elastom√©rico com descolamento, rasgos ressecamento ou deslocamento</option>
<option data-category="pavimentacao" value="3.13">3.13 - Abertura excessiva da junta de dilata√ß√£o</option>
<option data-category="pavimentacao" value="3.14">3.14 - Trincas</option>
<option data-category="pavimentacao" value="3.15">3.15 - Fissuras</option>
<option data-category="pavimentacao" value="3.16">3.16 - Panela</option>
<option data-category="pavimentacao" value="3.17">3.17 - Exsuda√ß√£o</option>
<option data-category="pavimentacao" value="3.18">3.18 - Defeitos nos trilhos (ondula√ß√µes e desgastes)</option>
<option data-category="pavimentacao" value="3.19">3.19 - Falha de adensamento do lastro</option>
<option data-category="pavimentacao" value="3.20">3.20 - Dormentes soltos, ausentes ou danificados</option>
<option data-category="pavimentacao" value="3.21">3.21 - Fixa√ß√µes danificadas</option>
<option data-category="pavimentacao" value="3.22">3.22 - Trilhos desalinhados em regi√£o de junta</option>
<option data-category="pavimentacao" value="3.23">3.23 - Espessura excessiva do lastro</option>
<option data-category="pavimentacao" value="3.24">3.24 - Trincas tipo "couro de jacar√©"</option>
<option data-category="pavimentacao" value="3.25">3.25 - Dano em pavimento r√≠gido</option>
</optgroup>
<optgroup label="4. APARELHOS DE APOIO">
<option data-category="apoios" value="4.1">4.1 - Aus√™ncia de aparelho de apoio</option>
<option data-category="apoios" value="4.2">4.2 - Bloqueio</option>
<option data-category="apoios" value="4.3">4.3 - Posicionamento inadequado</option>
<option data-category="apoios" value="4.4">4.4 - Ac√∫mulo de detritos, ocorr√™ncia de agentes agressivos</option>
<option data-category="apoios" value="4.5">4.5 - Ruptura</option>
<option data-category="apoios" value="4.6">4.6 - Fissuras</option>
<option data-category="apoios" value="4.7">4.7 - Trincas</option>
<option data-category="apoios" value="4.8">4.8 - Esmagamento</option>
<option data-category="apoios" value="4.9">4.9 - Deforma√ß√µes laterais excessivas</option>
<option data-category="apoios" value="4.10">4.10 - Deslocamentos</option>
<option data-category="apoios" value="4.11">4.11 - Distor√ß√£o excessiva</option>
<option data-category="apoios" value="4.12">4.12 - Pe√ßas de a√ßo oxidadas e expostas</option>
<option data-category="apoios" value="4.13">4.13 - Descolamento da fretagem</option>
<option data-category="apoios" value="4.14">4.14 - Assentamento irregular com concentra√ß√£o de esfor√ßos</option>
<option data-category="apoios" value="4.15">4.15 - Deteriora√ß√£o do ber√ßo de assentamento e de nivelamento superior</option>
</optgroup>
</select></div>
                            <div class="form-row"><div class="form-group"><label for="comprimento">Comprimento (m):</label><input type="number" id="comprimento" name="comprimento" step="0.01" min="0"></div><div class="form-group"><label for="largura">Largura (m):</label><input type="number" id="largura" name="largura" step="0.01" min="0"></div></div>
                            <div class="form-group"><label for="abertura">Abertura de Fissuras:</label><select id="abertura" name="abertura"><option value="">Selecione...</option>
<script> for(let i = 10; i <= 1000; i += 5) { let v = (i / 100).toFixed(2).replace('.', ','); document.write(`<option value="W${v}">W${v}</option>`); } </script>
</select></div>
                        </div>
                        <div class="section">
                            <div class="section-header"><h3><span class="icon">üì∏</span> Controle de Fotos</h3></div>
                            <div class="form-row"><div class="form-group"><label for="tipo_foto">Tipo de Foto:</label><select id="tipo_foto" name="tipo_foto"><option value="camera">C√¢mera</option><option value="drone">Drone</option></select></div><div class="form-group"><label for="qtdFotos">Quantidade:</label><input type="number" id="qtdFotos" name="qtdFotos" value="2" min="1"></div></div>
                            <div id="contador_camera_group" class="form-group"><label for="fotoInicialCamera">Numera√ß√£o Inicial (C√¢mera):</label><input type="number" id="fotoInicialCamera" min="1"></div>
                            <div id="contador_drone_group" class="form-group hidden"><label for="fotoInicialDrone">Numera√ß√£o Inicial (Drone):</label><input type="number" id="fotoInicialDrone" min="1"></div>
                            <div class="photo-info"><p id="fotoInfo"></p></div><input type="hidden" id="fotoInicial" name="fotoInicial">
                        </div>
                        <div class="section">
                            <div class="section-header"><h3><span class="icon">üìù</span> Observa√ß√µes</h3></div>
                            <div class="form-group"><label for="observacoes">Observa√ß√µes Adicionais:</label><textarea id="observacoes" name="observacoes" rows="3" placeholder="Descri√ß√£o detalhada..."></textarea></div>
                        </div>
                        <button type="submit" id="submitBtn" class="btn btn-primary">üíæ Salvar Registro</button>
                        <button type="button" id="cancelEditBtn" class="btn btn-warning hidden">Cancelar Edi√ß√£o</button>
                    </div>
                </form>
                <hr style="margin-top: 30px; border: 0; border-top: 1px solid #eee;">
                <h3 style="text-align: center; color: #34495e; margin: 20px 0;">Registros da Inspe√ß√£o Ativa</h3>
                <div id="registrosList" class="registros-list"></div>
                <button type="button" id="exportButton" class="btn btn-primary" style="background: linear-gradient(135deg, #3498db, #2980b9);">üìÑ Exportar Registros</button>
            </div>
            <!-- Nova aba: Caracter√≠sticas Gerais -->
            <div id="caracteristicas_gerais" class="tab-content">
                <div class="section">
                    <div class="section-header">
                        <h3><span class="icon">üèóÔ∏è</span> Caracter√≠sticas Gerais da Obra</h3>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="comprimento_total">Comprimento total (m):</label>
                            <input type="number" id="comprimento_total" step="0.01" min="0">
                        </div>
                        <div class="form-group">
                            <label for="largura_total">Largura total (m):</label>
                            <input type="number" id="largura_total" step="0.01" min="0">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="largura_util">Largura √∫til (m):</label>
                            <input type="number" id="largura_util" step="0.01" min="0">
                        </div>
                        <div class="form-group">
                            <label for="sentido_crescente">Sentido crescente da rodovia:</label>
                            <select id="sentido_crescente">
                                <option value="">Selecione...</option>
                                <option value="Norte">Norte</option>
                                <option value="Sul">Sul</option>
                                <option value="Leste">Leste</option>
                                <option value="Oeste">Oeste</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="qtd_vaos">Quantidade de v√£os:</label>
                            <input type="number" id="qtd_vaos" min="0">
                        </div>
                        <div class="form-group">
                            <label for="pilares">Pilares:</label>
                            <input type="text" id="pilares">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="juntas_dilatacao">Juntas de dilata√ß√£o:</label>
                            <input type="text" id="juntas_dilatacao">
                        </div>
                        <div class="form-group">
                            <label for="vaos_tipo">V√£os‚Äëtipo (isost√°tico, cont√≠nuo):</label>
                            <input type="text" id="vaos_tipo">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="tabuleiro_tipo">Tabuleiro‚Äëtipo:</label>
                        <input type="text" id="tabuleiro_tipo">
                    </div>
                    <div class="form-group">
                        <label for="tipologia_longitudinal">Tipologia longitudinal (Superestrutura):</label>
                        <select id="tipologia_longitudinal">
                            <option value="">Selecione...</option>
                            <option value="Biapoiado">Biapoiado</option>
                            <option value="Isost√°tica">Isost√°tica</option>
                            <option value="Cont√≠nua">Cont√≠nua</option>
                            <option value="V√£o apoiado em consolo ou dente Gerber">V√£o apoiado em consolo ou dente Gerber</option>
                            <option value="Arco superior">Arco superior</option>
                            <option value="Arco intermedi√°rio">Arco intermedi√°rio</option>
                            <option value="Arco inferior">Arco inferior</option>
                            <option value="P√≥rtico">P√≥rtico</option>
                            <option value="Estaiada">Estaiada</option>
                            <option value="P√™nsil">P√™nsil</option>
                            <option value="Treli√ßa">Treli√ßa</option>
                            <option value="Outra">Outra</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="tipologia_transversal">Tipologia transversal (Superestrutura):</label>
                        <select id="tipologia_transversal">
                            <option value="">Selecione...</option>
                            <option value="Laje">Laje</option>
                            <option value="Duas vigas">Duas vigas</option>
                            <option value="Grelha">Grelha</option>
                            <option value="Se√ß√£o celular">Se√ß√£o celular</option>
                            <option value="Treli√ßa">Treli√ßa</option>
                            <option value="Outras">Outras</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="tipologia_mesoestrutura">Tipologia da mesoestrutura:</label>
                        <select id="tipologia_mesoestrutura">
                            <option value="">Selecione...</option>
                            <option value="Pilares isolados">Pilares isolados</option>
                            <option value="Pilares com travessa">Pilares com travessa</option>
                            <option value="Pilares contraventados">Pilares contraventados</option>
                            <option value="Pilares parede">Pilares parede</option>
                            <option value="Pilones">Pilones</option>
                            <option value="Outras">Outras</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="tipologia_infraestrutura">Tipologia da infraestrutura:</label>
                        <select id="tipologia_infraestrutura">
                            <option value="">Selecione...</option>
                            <option value="Funda√ß√£o superficial">Funda√ß√£o superficial</option>
                            <option value="Tubul√µes">Tubul√µes</option>
                            <option value="Estaca escavada">Estaca escavada</option>
                            <option value="Estaca pr√©-moldada">Estaca pr√©-moldada</option>
                            <option value="Estaca met√°lica">Estaca met√°lica</option>
                            <option value="Estaca de madeira">Estaca de madeira</option>
                            <option value="N√£o identificado">N√£o identificado</option>
                            <option value="Outras">Outras</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="sistemas_construtivos">Sistemas construtivos:</label>
                        <select id="sistemas_construtivos">
                            <option value="">Selecione...</option>
                            <option value="Moldado no local">Moldado no local</option>
                            <option value="Pr√©-moldado somente armado">Pr√©-moldado somente armado</option>
                            <option value="Pr√©-moldado protendido (p√≥s-tens√£o)">Pr√©-moldado protendido (p√≥s-tens√£o)</option>
                            <option value="Pr√©-moldado protendido (pr√©-tens√£o)">Pr√©-moldado protendido (pr√©-tens√£o)</option>
                            <option value="Balan√ßo sucessivo">Balan√ßo sucessivo</option>
                            <option value="Aduelas pr√©-moldadas">Aduelas pr√©-moldadas</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="natureza_transposicao">Natureza da transposi√ß√£o:</label>
                        <select id="natureza_transposicao">
                            <option value="">Selecione...</option>
                            <option value="Superf√≠cie aqu√≠fera">Superf√≠cie aqu√≠fera</option>
                            <option value="Rodovia">Rodovia</option>
                            <option value="Ferrovia">Ferrovia</option>
                            <option value="Vale">Vale</option>
                            <option value="Grota">Grota</option>
                            <option value="Contorno de encosta">Contorno de encosta</option>
                            <option value="Via urbana">Via urbana</option>
                            <option value="Via de pedestre">Via de pedestre</option>
                            <option value="Outras">Outras</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="materiais">Materiais:</label>
                        <select id="materiais">
                            <option value="">Selecione...</option>
                            <option value="Concreto simples (CS)">Concreto simples (CS)</option>
                            <option value="Concreto armado (CA)">Concreto armado (CA)</option>
                            <option value="Concreto protendido (CP)">Concreto protendido (CP)</option>
                            <option value="A√ßo (A)">A√ßo (A)</option>
                            <option value="Madeira (MD)">Madeira (MD)</option>
                            <option value="Pedra argamassada (PA)">Pedra argamassada (PA)</option>
                            <option value="Mista (MI)">Mista (MI)</option>
                            <option value="Alvenaria (AL)">Alvenaria (AL)</option>
                            <option value="N√£o identificado">N√£o identificado</option>
                            <option value="Outros">Outros</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="qtd_aparelhos_apoio">Quantidade de aparelhos de apoio:</label>
                            <input type="number" id="qtd_aparelhos_apoio" min="0">
                        </div>
                        <div class="form-group">
                            <label for="gabarito_vertical_sob">Gabarito vertical sob a OAE (m):</label>
                            <input type="number" id="gabarito_vertical_sob" step="0.01" min="0">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="gabarito_vertical_sobre">Gabarito vertical sobre a OAE (m):</label>
                            <input type="number" id="gabarito_vertical_sobre" step="0.01" min="0">
                        </div>
                        <div class="form-group">
                            <label for="gabarito_navegavel_altura">Gabarito naveg√°vel ‚Äî Altura (m):</label>
                            <input type="number" id="gabarito_navegavel_altura" step="0.01" min="0">
                        </div>
                        <div class="form-group">
                            <label for="gabarito_navegavel_largura">Gabarito naveg√°vel ‚Äî Largura (m):</label>
                            <input type="number" id="gabarito_navegavel_largura" step="0.01" min="0">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <footer class="footer"><p>Desenvolvido por: Jo√£o R√¥mulo Gomes</p></footer>
    </div>
    <div id="legendaModal" class="modal"><div class="modal-content"><div class="modal-header"><h2>Legendas dos Elementos</h2><span class="close-button">&times;</span></div><div class="legenda-table"><table><tr><th>Sigla</th><th>Descri√ß√£o</th></tr><tr><td>AA</td><td>Aparelho de apoio</td></tr><tr><td>AB</td><td>Ab√≥bada</td></tr><tr><td>AC</td><td>Acesso</td></tr><tr><td>AD</td><td>Aduela</td></tr><tr><td>AL</td><td>Muro de ala</td></tr><tr><td>ALE</td><td>Alma externa (caix√£o)</td></tr><tr><td>ALI</td><td>Alma interna (caix√£o)</td></tr><tr><td>AP</td><td>Apoio</td></tr><tr><td>B√á</td><td>Ber√ßo</td></tr><tr><td>BL</td><td>Balan√ßo longitudinal</td></tr><tr><td>BLC</td><td>Bloco de funda√ß√£o</td></tr><tr><td>BR</td><td>Barreira r√≠gida</td></tr><tr><td>BU</td><td>Bueiro</td></tr><tr><td>BUZ</td><td>Buzinote</td></tr><tr><td>BZ</td><td>Banzo</td></tr><tr><td>CEL</td><td>C√©lula</td></tr><tr><td>CO</td><td>Cortina</td></tr><tr><td>DG</td><td>Dente gerber</td></tr><tr><td>DI</td><td>Diagonal</td></tr><tr><td>DM</td><td>Defensa met√°lica</td></tr><tr><td>DR</td><td>Drenagem</td></tr>
<tr><td>EB</td><td>Emboque</td></tr><tr><td>ENC</td><td>Encontro</td></tr><tr><td>ET</td><td>Estaca</td></tr><tr><td>GC</td><td>Guarda-corpos</td></tr><tr><td>GR</td><td>Guarda-rodas</td></tr><tr><td>JD</td><td>Junta de dilata√ß√£o</td></tr><tr><td>LB</td><td>Laje em balan√ßo (transversal)</td></tr></table><table><tr><th>Sigla</th><th>Descri√ß√£o</th></tr><tr><td>LI</td><td>Laje inferior</td></tr><tr><td>LS</td><td>Laje superior</td></tr><tr><td>LT</td><td>Laje de transi√ß√£o</td></tr><tr><td>MF</td><td>Meio-Fio</td></tr><tr><td>MT</td><td>Montante</td></tr><tr><td>P</td><td>Pilar</td></tr><tr><td>PA</td><td>Parede</td></tr><tr><td>PC</td><td>Piso de concreto</td></tr><tr><td>PF</td><td>Pavimento fex√≠vel</td></tr><tr><td>PIL</td><td>Pilone</td></tr><tr><td>PR</td><td>Pavimento r√≠gido</td></tr><tr><td>PS</td><td>Passeio</td></tr><tr><td>SAP</td><td>Sapata</td></tr><tr><td>SH</td><td>Sinaliza√ß√£o Horizontal</td></tr><tr><td>SJ</td><td>Sarjeta</td></tr><tr><td>SV</td><td>Sinaliza√ß√£o Vertical</td></tr><tr><td>TA</td><td>Talude</td></tr><tr><td>TRE</td><td>Treli√ßa</td></tr><tr><td>TUB</td><td>Tubul√£o</td></tr><tr><td>V</td><td>V√£o</td></tr><tr><td>VA</td><td>Valeta</td></tr><tr><td>VL</td><td>Viga longarina</td></tr><tr><td>VLR</td><td>Viga longarina de rampa</td></tr><tr><td>VLT</td><td>Viga longarina de travessia</td></tr><tr><td>VT</td><td>Viga transversina</td></tr><tr><td>VTR</td><td>Viga travessa</td></tr><tr><td>VTRAV</td><td>Viga de travamento</td></tr></table></div></div></div>

    <!-- Input file oculto para importar planilha -->
    <input type="file" id="fileInput" accept=".xlsx,.xls" style="display: none;">

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', () => showTab(tab.dataset.tab, tab));
            });
        });

        function showTab(tabName, element) {
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            element.classList.add('active');
        }
    </script>
</body>
</html>
